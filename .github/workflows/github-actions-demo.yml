name: GitHub Actions Demo
on: [push]
jobs:
  lint:
    runs-on: ubuntu-18.04
    steps:
      - name: Check out repository code
        uses: actions/checkout@v2
      - name: Run clang-format
        run: |
          ./scripts/format.sh > /dev/null
          diff=$(git diff)

          if [[ ${diff} ]]; then
            echo ${diff}
            exit 1
          fi

      - run: echo "🍏 This job's status is ${{ job.status }}."
  linux-tests:
    runs-on: ubuntu-18.04
    steps:
      - name: Check out repository code
        uses: actions/checkout@v2
      - name: Build project
        run: mkdir build && cd build && cmake .. && make
        env:
          CC:  gcc-10
          CXX: g++-10
      - name: Run tests
        run: ./build/test/unit_tests
      - run: echo "🍏 This job's status is ${{ job.status }}."